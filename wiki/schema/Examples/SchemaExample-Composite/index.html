<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>Composite Entity - LambdaORM Wiki</title>
        <link href="../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

        <script src="../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../..">LambdaORM Wiki</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../../.." class="nav-link">Î»ORM "We don't reinvent the wheel, we improve it"</a>
                            </li>
                            <li class="navitem">
                                <a href="../../../Features/" class="nav-link">Features</a>
                            </li>
                            <li class="navitem">
                                <a href="../../../Sidebar/" class="nav-link">Sidebar</a>
                            </li>
                            <li class="navitem">
                                <a href="../../../Usage/" class="nav-link">Usage</a>
                            </li>
                            <li class="navitem">
                                <a href="../../../function_functions/" class="nav-link">Function functions</a>
                            </li>
                            <li class="navitem">
                                <a href="../../../operator_operators/" class="nav-link">Operator operators</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Queries <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../queries/Expression/" class="dropdown-item">Lambda expressions</a>
</li>
                                    
<li>
    <a href="../../../queries/Metadata/" class="dropdown-item">Metadata</a>
</li>
                                    
<li>
    <a href="../../../queries/Query-Language/" class="dropdown-item">Query Language</a>
</li>
                                    
<li>
    <a href="../../../queries/Repository/" class="dropdown-item">Repositories</a>
</li>
                                    
<li>
    <a href="../../../queries/Transaction/" class="dropdown-item">Transaction</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Dml</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../queries/dml/BulkInsert/" class="dropdown-item">BulkInsert</a>
</li>
            
<li>
    <a href="../../../queries/dml/Delete/" class="dropdown-item">Delete</a>
</li>
            
<li>
    <a href="../../../queries/dml/Insert/" class="dropdown-item">Insert</a>
</li>
            
<li>
    <a href="../../../queries/dml/Update/" class="dropdown-item">Update</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Dql</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../queries/dql/Grouping/" class="dropdown-item">Grouping</a>
</li>
            
<li>
    <a href="../../../queries/dql/Include/" class="dropdown-item">Include</a>
</li>
            
<li>
    <a href="../../../queries/dql/Join/" class="dropdown-item">Join</a>
</li>
            
<li>
    <a href="../../../queries/dql/Select/" class="dropdown-item">Select</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">operatorsAndFunctions</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../queries/operatorsAndFunctions/Bitwise/" class="dropdown-item">Bitwise</a>
</li>
            
<li>
    <a href="../../../queries/operatorsAndFunctions/Comparison/" class="dropdown-item">Comparison</a>
</li>
            
<li>
    <a href="../../../queries/operatorsAndFunctions/Datetime/" class="dropdown-item">Datetime</a>
</li>
            
<li>
    <a href="../../../queries/operatorsAndFunctions/Group/" class="dropdown-item">Group</a>
</li>
            
<li>
    <a href="../../../queries/operatorsAndFunctions/Logical/" class="dropdown-item">Logical</a>
</li>
            
<li>
    <a href="../../../queries/operatorsAndFunctions/Nullable/" class="dropdown-item">Nullable</a>
</li>
            
<li>
    <a href="../../../queries/operatorsAndFunctions/Numeric/" class="dropdown-item">Numeric</a>
</li>
            
<li>
    <a href="../../../queries/operatorsAndFunctions/Sort/" class="dropdown-item">Sort</a>
</li>
            
<li>
    <a href="../../../queries/operatorsAndFunctions/String/" class="dropdown-item">String</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Schema <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../Schema-Use/" class="dropdown-item">Schema Use</a>
</li>
                                    
<li>
    <a href="../../Schema/" class="dropdown-item">Schema</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Definition</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../Definition/SchemaDefinition-Composite/" class="dropdown-item">Composite Entity</a>
</li>
            
<li>
    <a href="../../Definition/SchemaDefinition-EnvironmentVariables/" class="dropdown-item">Environment Variables on Schema</a>
</li>
            
<li>
    <a href="../../Definition/SchemaDefinition-Expressions/" class="dropdown-item">Expressions on Schema</a>
</li>
            
<li>
    <a href="../../Definition/SchemaDefinition/" class="dropdown-item">Definition</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Examples</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../SchemaExample-Basic/" class="dropdown-item">Basic Schema Example</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active">Composite Entity</a>
</li>
            
<li>
    <a href="../SchemaExample-Extend/" class="dropdown-item">Extend</a>
</li>
            
<li>
    <a href="../SchemaExample-Listener/" class="dropdown-item">Listener on Schema</a>
</li>
            
<li>
    <a href="../SchemaExample-MultiplesStages/" class="dropdown-item">Multiples Stages</a>
</li>
            
<li>
    <a href="../SchemaExample-StageMultiplesSources/" class="dropdown-item">Stage related multiples Sources</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Synchronization</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../Synchronization/SchemaSynchronization-Fetch/" class="dropdown-item">Fetch</a>
</li>
            
<li>
    <a href="../../Synchronization/SchemaSynchronization-Incorporate/" class="dropdown-item">Incorporate</a>
</li>
            
<li>
    <a href="../../Synchronization/SchemaSynchronization-Introspect/" class="dropdown-item">Introspect</a>
</li>
            
<li>
    <a href="../../Synchronization/SchemaSynchronization-Pull/" class="dropdown-item">Pull</a>
</li>
            
<li>
    <a href="../../Synchronization/SchemaSynchronization-Push/" class="dropdown-item">Push</a>
</li>
            
<li>
    <a href="../../Synchronization/SchemaSynchronization/" class="dropdown-item">Synchronization</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../SchemaExample-Basic/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../SchemaExample-Extend/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-light">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#composite-entity" class="nav-link">Composite Entity</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#composite-example" class="nav-link">Composite Example</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#composite-example-in-different-datasources" class="nav-link">Composite example in different datasources</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#queries" class="nav-link">Queries</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#laboratories" class="nav-link">Laboratories</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="composite-entity">Composite Entity</h1>
<p>Using the period in the name of an entity we can define a composite entity. \
For example, if we have an entity Orders and another Orders.details \
The Orders.details entity is a composite entity of the Orders entity. \</p>
<p>If the datasource is NoSQL, the data will be stored in a single collection but if the datasource is Relational, the data will be stored in separate tables. \</p>
<p>But on the domain side it will be treated the same regardless of the type of datasource. \
abstracting from persistence technology.</p>
<h2 id="composite-example">Composite Example</h2>
<p>In this example we can see that we have an entity Orders and another Orders.details \
The Orders.details entity is a composite entity of the Orders entity. \</p>
<p><strong>Part of the schema where the composite entity is defined:</strong></p>
<pre><code class="language-yaml">domain:  
  entities:
...  
  - name: Orders
    primaryKey: [id]
    indexes:
    - name: orderDate
      fields: [orderDate]
    properties:
    - name: id
      type: integer
      required: true
      autoIncrement: true
    - name: customerId
      required: true
      length: 5
    - name: orderDate
      type: dateTime 
  - name: Orders.details
    primaryKey: [orderId, productId]
    properties:
    - name: orderId
      required: true
      type: integer
    - name: productId
      required: true
      type: integer
    - name: unitPrice
      type: decimal
    - name: quantity
      type: decimal
    relations:
    - name: order
      from: orderId
      entity: Orders
      to: id
      target: details
...
</code></pre>
<p><strong>Schema Complete:</strong></p>
<pre><code class="language-yaml">domain:  
  entities:
  - name: Address
    abstract: true
    indexes:
    - name: postalCode
      fields: [&quot;postalCode&quot;]
    - name: region
      fields: [&quot;region&quot;, &quot;country&quot;]
    - name: city
      fields: [&quot;city&quot;]
    properties:
    - name: address
    - name: city
    - name: region
    - name: postalCode
      length: 20
    - name: country
  - name: Categories
    primaryKey: [&quot;id&quot;]
    uniqueKey: [&quot;name&quot;]
    properties:
    - name: id
      type: integer
      required: true
      autoIncrement: true
    - name: name
      required: true
  - name: Customers
    extends: Address
    primaryKey: [&quot;id&quot;]
    indexes:
    - name: name
      fields: [&quot;name&quot;]
    properties:
    - name: id
      length: 5
      required: true
    - name: name
      required: true
  - name: Products
    primaryKey: [&quot;id&quot;]
    uniqueKey: [&quot;name&quot;, &quot;supplierId&quot;]
    properties:
    - name: id
      type: integer
      required: true
      autoIncrement: true
    - name: name
      required: true
    - name: categoryId
      type: integer
    - name: quantity
    - name: price
      type: decimal
      default: 0
    relations:
    - name: category
      from: categoryId
      entity: Categories
      to: id
      target: products
  - name: Orders
    primaryKey: [&quot;id&quot;]
    indexes:
    - name: orderDate
      fields: [&quot;orderDate&quot;]
    properties:
    - name: id
      type: integer
      required: true
      autoIncrement: true
    - name: customerId
      required: true
      length: 5
    - name: orderDate
      type: dateTime 
    relations:
    - name: customer
      from: customerId
      entity: Customers
      to: id
      target: orders
  - name: Orders.details
    primaryKey: [&quot;orderId&quot;, &quot;productId&quot;]
    properties:
    - name: orderId
      required: true
      type: integer
    - name: productId
      required: true
      type: integer
    - name: unitPrice
      type: decimal
    - name: quantity
      type: decimal
    relations:
    - name: order
      from: orderId
      entity: Orders
      to: id
      target: details
    - name: product
      from: productId
      entity: Products
      to: id
      target: orderDetails
infrastructure:
  views:
  - name: default  
  mappings:
  - name: default
    entities:
    - name: Address
      abstract: true
      properties:
      - name: address
        mapping: Address
      - name: city
        mapping: City
      - name: region
        mapping: Region
      - name: postalCode
        mapping: PostalCode
      - name: country
        mapping: Country
    - name: Categories
      mapping: Categories
      properties:
      - name: id
        mapping: CategoryID
      - name: name
        mapping: CategoryName
    - name: Customers
      extends: Address
      mapping: Customers
      properties:
      - name: id
        mapping: CustomerID
      - name: name
        mapping: CompanyName
    - name: Products
      mapping: Products
      properties:
      - name: id
        mapping: ProductID
      - name: name
        mapping: ProductName
      - name: categoryId
        mapping: CategoryID
      - name: quantity
        mapping: QuantityPerUnit
      - name: price
        mapping: UnitPrice
    - name: Orders
      mapping: Orders
      properties:
      - name: id
        mapping: OrderID
      - name: customerId
        mapping: CustomerID
      - name: orderDate
        mapping: OrderDate
    - name: Orders.details
      mapping: Order Details
      properties:
      - name: orderId
        mapping: OrderID
      - name: productId
        mapping: ProductID
      - name: unitPrice
        mapping: UnitPrice
      - name: quantity
        mapping: Quantity
  - name: mongoDb
    extends: default
    entities:
      - name: Orders
        sequence: SQ_ORDERS
        properties:
          - name: id
            mapping: _id
  sources:
  - name: Catalog      
    dialect: MySQL
    mapping: default
    connection: ${CNN_MYSQL}      
  - name: Crm    
    dialect: PostgreSQL
    mapping: default
    connection: ${CNN_POSTGRES}
  - name: Ordering
    dialect: MongoDB
    mapping: mongoDb      
    connection: ${CNN_MONGODB}    
  stages:
  - name: default
    sources:
    - name: Catalog
      condition: entity.in([&quot;Categories&quot;,&quot;Products&quot;])
    - name: Crm
      condition: entity.in([&quot;Address&quot;,&quot;Customers&quot;])
    - name: Ordering
      condition: entity.in([&quot;Orders&quot;,&quot;Orders.details&quot;])   
</code></pre>
<p><strong>Environment Variables:</strong></p>
<pre><code class="language-sh">CNN_MYSQL={&quot;host&quot;:&quot;localhost&quot;,&quot;port&quot;:3306,&quot;user&quot;:&quot;test&quot;,&quot;password&quot;:&quot;test&quot;,&quot;database&quot;:&quot;test&quot;}
CNN_POSTGRES={&quot;host&quot;:&quot;localhost&quot;,&quot;port&quot;:5433,&quot;user&quot;:&quot;test&quot;,&quot;password&quot;:&quot;test&quot;,&quot;database&quot;:&quot;test&quot;}
CNN_MONGODB={&quot;url&quot;:&quot;mongodb://test:test@localhost:27017&quot;,&quot;database&quot;:&quot;test&quot;}
</code></pre>
<p><strong>Laboratory:</strong></p>
<p><a href="https://github.com/lambda-orm/lambdaorm-labs/tree/main/labs/cli/06-northwind-multiples-datasources">CLI - northwind multiples datasources</a></p>
<h2 id="composite-example-in-different-datasources">Composite example in different datasources</h2>
<p>En este ejemple podemos ver como se trata una entidad compuesta en diferentes datasources. \
En el stage default se utiliza Mongo para almacenar las Orders y Orders.details \
En el stage insights se utiliza Postgres para almacenar las Orders y Orders.details  </p>
<p><strong>Part of the schema where the stages are configured:</strong></p>
<pre><code class="language-yaml">...
  stages:
  - name: default
    sources:
    - name: Catalog
      condition: entity.in([&quot;Categories&quot;,&quot;Products&quot;])
    - name: Crm
      condition: entity.in([&quot;Address&quot;,&quot;Customers&quot;])
    - name: Ordering
      condition: entity.in([&quot;Orders&quot;,&quot;Orders.details&quot;])
  - name: insights
    sources:
    - name: Insights
...
</code></pre>
<p><strong>Schema Complete:</strong></p>
<pre><code class="language-yaml">domain:  
  enums:
  entities:
  - name: Address
    abstract: true
    indexes:
    - name: postalCode
      fields: [&quot;postalCode&quot;]
    - name: region
      fields: [&quot;region&quot;, &quot;country&quot;]
    - name: city
      fields: [&quot;city&quot;]
    properties:
    - name: address
    - name: city
    - name: region
    - name: postalCode
      length: 20
    - name: country
  - name: Categories
    primaryKey: [&quot;id&quot;]
    uniqueKey: [&quot;name&quot;]
    properties:
    - name: id
      type: integer
      required: true
      autoIncrement: true
    - name: name
      required: true
  - name: Customers
    extends: Address
    primaryKey: [&quot;id&quot;]
    indexes:
    - name: name
      fields: [&quot;name&quot;]
    properties:
    - name: id
      length: 5
      required: true
    - name: name
      required: true
  - name: Products
    primaryKey: [&quot;id&quot;]
    uniqueKey: [&quot;name&quot;, &quot;supplierId&quot;]
    properties:
    - name: id
      type: integer
      required: true
      autoIncrement: true
    - name: name
      required: true
    - name: categoryId
      type: integer
    - name: quantity
    - name: price
      type: decimal
      default: 0
    relations:
    - name: category
      from: categoryId
      entity: Categories
      to: id
      target: products
  - name: Orders
    primaryKey: [&quot;id&quot;]
    indexes:
    - name: orderDate
      fields: [&quot;orderDate&quot;]
    properties:
    - name: id
      type: integer
      required: true
      autoIncrement: true
    - name: customerId
      required: true
      length: 5
    - name: orderDate
      type: dateTime 
    relations:
    - name: customer
      from: customerId
      entity: Customers
      to: id
      target: orders
  - name: Orders.details
    primaryKey: [&quot;orderId&quot;, &quot;productId&quot;]
    properties:
    - name: orderId
      required: true
      type: integer
    - name: productId
      required: true
      type: integer
    - name: unitPrice
      type: decimal
    - name: quantity
      type: decimal
    relations:
    - name: order
      from: orderId
      entity: Orders
      to: id
      target: details
    - name: product
      from: productId
      entity: Products
      to: id
      target: orderDetails
infrastructure:
  views:
  - name: default  
  mappings:
  - name: default
    entities:
    - name: Address
      abstract: true
      properties:
      - name: address
        mapping: Address
      - name: city
        mapping: City
      - name: region
        mapping: Region
      - name: postalCode
        mapping: PostalCode
      - name: country
        mapping: Country
    - name: Categories
      mapping: Categories
      properties:
      - name: id
        mapping: CategoryID
      - name: name
        mapping: CategoryName
    - name: Customers
      extends: Address
      mapping: Customers
      properties:
      - name: id
        mapping: CustomerID
      - name: name
        mapping: CompanyName
    - name: Products
      mapping: Products
      properties:
      - name: id
        mapping: ProductID
      - name: name
        mapping: ProductName
      - name: categoryId
        mapping: CategoryID
      - name: quantity
        mapping: QuantityPerUnit
      - name: price
        mapping: UnitPrice
    - name: Orders
      mapping: Orders
      properties:
      - name: id
        mapping: OrderID
      - name: customerId
        mapping: CustomerID
      - name: orderDate
        mapping: OrderDate
    - name: Orders.details
      mapping: Order Details
      properties:
      - name: orderId
        mapping: OrderID
      - name: productId
        mapping: ProductID
      - name: unitPrice
        mapping: UnitPrice
      - name: quantity
        mapping: Quantity
  - name: mongoDb
    extends: default
    entities:
      - name: Orders
        sequence: SQ_ORDERS
        properties:
          - name: id
            mapping: _id
  sources:
  - name: Catalog      
    dialect: MySQL
    mapping: default
    connection: ${CNN_MYSQL}      
  - name: Crm    
    dialect: PostgreSQL
    mapping: default
    connection: ${CNN_POSTGRES}
  - name: Ordering
    dialect: MongoDB
    mapping: mongoDb      
    connection: ${CNN_MONGODB}
  - name: Insights    
    dialect: PostgreSQL
    mapping: default
    connection: ${CNN_INSIGHTS}      
  stages:
  - name: default
    sources:
    - name: Catalog
      condition: entity.in([&quot;Categories&quot;,&quot;Products&quot;])
    - name: Crm
      condition: entity.in([&quot;Address&quot;,&quot;Customers&quot;])
    - name: Ordering
      condition: entity.in([&quot;Orders&quot;,&quot;Orders.details&quot;])
  - name: insights
    sources:
    - name: Insights
</code></pre>
<h3 id="orders-composite-in-mongodb">Orders Composite in MongoDb</h3>
<p>Orders collection:</p>
<p><img alt="OrderCompositeInMongo" src="https://raw.githubusercontent.com/lambda-orm/lambdaorm/HEAD/images/OrderCompositeInMongo.png" /></p>
<h3 id="orders-composite-in-postgres">Orders Composite in Postgres</h3>
<p>Orders table:</p>
<p><img alt="OrderCompositeInPostgres" src="https://raw.githubusercontent.com/lambda-orm/lambdaorm/HEAD/images/OrderCompositeInPostgres.png" /></p>
<p>Orders details table:</p>
<p><img alt="OrderDetailsCompositeInPostgres" src="https://raw.githubusercontent.com/lambda-orm/lambdaorm/HEAD/images/OrderDetailCompositeInPostgres.png" /></p>
<h2 id="queries">Queries</h2>
<p>But if we execute the same query in the different stages we can see that the result is the same</p>
<h3 id="query-on-default-stage">Query on default stage</h3>
<pre><code class="language-sh">lambdaorm execute -e &quot;.env&quot; -s default -q &quot;Orders.filter(p =&gt; p.customerId == customerId).include(p =&gt; [p.customer.map(p =&gt; p.name), p.details.include(p =&gt; p.product.include(p =&gt; p.category.map(p =&gt; p.name)).map(p =&gt; p.name)).map(p =&gt; [p.quantity, p.unitPrice])]).order(p=&gt; p.id).page(1,1)&quot; -d &quot;{\&quot;customerId\&quot;: \&quot;HANAR\&quot;}&quot;
</code></pre>
<p>Result:</p>
<pre><code class="language-json">[
  {
    &quot;id&quot;: 3,
    &quot;customerId&quot;: &quot;HANAR&quot;,
    &quot;employeeId&quot;: 4,
    &quot;orderDate&quot;: &quot;1996-07-08T00:00:00.000+02:00&quot;,
    &quot;requiredDate&quot;: &quot;1996-08-05&quot;,
    &quot;shippedDate&quot;: &quot;1996-07-12&quot;,
    &quot;shipViaId&quot;: 2,
    &quot;freight&quot;: 65.83,
    &quot;name&quot;: &quot;Hanari Carnes&quot;,
    &quot;address&quot;: &quot;Rua do Pao, 67&quot;,
    &quot;city&quot;: &quot;Rio de Janeiro&quot;,
    &quot;region&quot;: &quot;RJ&quot;,
    &quot;postalCode&quot;: &quot;05454-876&quot;,
    &quot;country&quot;: &quot;Brazil&quot;,
    &quot;details&quot;: [
      {
        &quot;quantity&quot;: 10,
        &quot;unitPrice&quot;: 7.7,
        &quot;product&quot;: {
          &quot;name&quot;: &quot;Jack's New England Clam Chowder&quot;,
          &quot;category&quot;: {
            &quot;name&quot;: &quot;Seafood&quot;
          }
        }
      },
      {
        &quot;quantity&quot;: 35,
        &quot;unitPrice&quot;: 42.4,
        &quot;product&quot;: {
          &quot;name&quot;: &quot;Manjimup Dried Apples&quot;,
          &quot;category&quot;: {
            &quot;name&quot;: &quot;Produce&quot;
          }
        }
      },
      {
        &quot;quantity&quot;: 15,
        &quot;unitPrice&quot;: 16.8,
        &quot;product&quot;: {
          &quot;name&quot;: &quot;Louisiana Fiery Hot Pepper Sauce&quot;,
          &quot;category&quot;: {
            &quot;name&quot;: &quot;Condiments&quot;
          }
        }
      }
    ],
    &quot;customer&quot;: {
      &quot;name&quot;: &quot;Hanari Carnes&quot;
    }
  }
]
</code></pre>
<h3 id="same-query-on-insights-stage">Same query on insights stage</h3>
<pre><code class="language-sh">lambdaorm execute -e &quot;.env&quot; -s insights -q &quot;Orders.filter(p =&gt; p.customerId == customerId).include(p =&gt; [p.customer.map(p =&gt; p.name), p.details.include(p =&gt; p.product.include(p =&gt; p.category.map(p =&gt; p.name)).map(p =&gt; p.name)).map(p =&gt; [p.quantity, p.unitPrice])]).order(p=&gt; p.id).page(1,1)&quot; -d &quot;{\&quot;customerId\&quot;: \&quot;HANAR\&quot;}&quot;
</code></pre>
<p>Result:</p>
<pre><code class="language-json">[
  {
    &quot;id&quot;: 3,
    &quot;customerId&quot;: &quot;HANAR&quot;,
    &quot;employeeId&quot;: 4,
    &quot;orderDate&quot;: &quot;1996-07-07T22:00:00.000Z&quot;,
    &quot;requiredDate&quot;: &quot;1996-08-04T22:00:00.000Z&quot;,
    &quot;shippedDate&quot;: &quot;1996-07-11T22:00:00.000Z&quot;,
    &quot;shipViaId&quot;: 2,
    &quot;freight&quot;: 65.83,
    &quot;name&quot;: &quot;Hanari Carnes&quot;,
    &quot;address&quot;: &quot;Rua do Pao, 67&quot;,
    &quot;city&quot;: &quot;Rio de Janeiro&quot;,
    &quot;region&quot;: &quot;RJ&quot;,
    &quot;postalCode&quot;: &quot;05454-876&quot;,
    &quot;country&quot;: &quot;Brazil&quot;,
    &quot;customer&quot;: {
      &quot;name&quot;: &quot;Hanari Carnes&quot;
    },
    &quot;details&quot;: [
      {
        &quot;quantity&quot;: 10,
        &quot;unitPrice&quot;: 7.7,
        &quot;product&quot;: {
          &quot;name&quot;: &quot;Jack's New England Clam Chowder&quot;,
          &quot;category&quot;: {
            &quot;name&quot;: &quot;Seafood&quot;
          }
        }
      },
      {
        &quot;quantity&quot;: 35,
        &quot;unitPrice&quot;: 42.4,
        &quot;product&quot;: {
          &quot;name&quot;: &quot;Manjimup Dried Apples&quot;,
          &quot;category&quot;: {
            &quot;name&quot;: &quot;Produce&quot;
          }
        }
      },
      {
        &quot;quantity&quot;: 15,
        &quot;unitPrice&quot;: 16.8,
        &quot;product&quot;: {
          &quot;name&quot;: &quot;Louisiana Fiery Hot Pepper Sauce&quot;,
          &quot;category&quot;: {
            &quot;name&quot;: &quot;Condiments&quot;
          }
        }
      }
    ]
  }
]
</code></pre>
<h2 id="laboratories">Laboratories</h2>
<ul>
<li><a href="https://github.com/lambda-orm/lambdaorm-labs/tree/main/labs/cli/05-northwind">CLI - northwind</a></li>
<li><a href="https://github.com/lambda-orm/lambdaorm-labs/tree/main/labs/cli/06-northwind-multiples-datasources">CLI - northwind multiples datasources</a></li>
<li><a href="https://github.com/lambda-orm/lambdaorm-labs/tree/main/labs/cli/07-northwind-multiples-stages">CLI - northwind multiples stages</a></li>
</ul></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js" defer></script>
        <script src="../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
