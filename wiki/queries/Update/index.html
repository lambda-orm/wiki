<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Update - λORM Wiki</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Update";
        var mkdocs_page_input_path = "queries/Update.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> λORM Wiki
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="" href="../../index.html">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../Usage/index.html">Usage</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../Features/index.html">Features</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../api/index.html">Api</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../cli/index.html">Cli</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="https://github.com/lambda-orm/lambdaorm-labs">Labs</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Queries</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="../Query-Language/index.html">Query Language</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../Expression/index.html">Expression</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../Select/index.html">Select</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../Join/index.html">Join</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../Grouping/index.html">Grouping</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../Include/index.html">Include</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../Insert/index.html">Insert</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../BulkInsert/index.html">Bulk Insert</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="index.html">Update</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../Delete/index.html">Delete</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Schema</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="../../schema/SchemaDefinition/index.html">Definition</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../schema/SchemaDefinition-Expressions/index.html">Expressions</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../schema/SchemaDefinition-EnvironmentVariables/index.html">Environment Variables</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../schema/SchemaDefinition-Composite/index.html">Composite</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../schema/SchemaExample-Listener/index.html">Listeners</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../schema/SchemaExample-Basic/index.html">Basic</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../schema/SchemaExample-Extend/index.html">Extend Entity</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../schema/SchemaExample-MultiplesStages/index.html">Multiples Stages</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../schema/SchemaExample-StageMultiplesSources/index.html">Stage with Multiples Sources</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../schema/SchemaExample-Composite/index.html">Entity Composite</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../schema/SchemaSynchronization-Push/index.html">Push</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../schema/SchemaSynchronization-Pull/index.html">Pull</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../schema/SchemaSynchronization-Fetch/index.html">Fetch</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../schema/SchemaSynchronization-Introspect/index.html">Introspect</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../schema/SchemaSynchronization-Incorporate/index.html">Incorporate</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../schema/Schema-Use/index.html">Use</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Usage</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="../../usage/Repository/index.html">Repository</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../usage/Transaction/index.html">Transaction</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../usage/Usage/index.html">Usage</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../usage/CHANGELOG/index.html">Change log</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">λORM Wiki</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Update</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="update">Update</h1>
<p>Since the queries are based on both the expression and the definition in the schema, in the case of wanting to update all the fields it is not necessary to define them since it is assumed if none are defined.</p>
<p>The mapping to the source(s) is resolved according to the mapping configuration associated with each source in the schema.</p>
<h2 id="update-one-entity-complete">Update one entity complete</h2>
<p><strong>Lambda:</strong></p>
<pre><code class="language-Typescript">// Updates all fields of the Orders entity
Orders.update()
</code></pre>
<p><strong>SQL Result:</strong></p>
<pre><code class="language-sql">-- Updates all fields of the Orders entity where OrderID matches the provided parameter
UPDATE Orders o SET 
    CustomerID = ?,
    EmployeeID = ?,
    OrderDate = ?,
    RequiredDate = ?,
    ShippedDate = ?,
    ShipVia = ?,
    Freight = ?,
    ShipName = ?,
    ShipAddress = ?,
    ShipCity = ?,
    ShipRegion = ?,
    ShipPostalCode = ?,
    ShipCountry = ? 
WHERE o.OrderID = ?
</code></pre>
<h2 id="update-one-field-of-entity-in-all-records">Update one field of entity in all records</h2>
<p><strong>Lambda:</strong></p>
<pre><code class="language-Typescript">// Updates the ShipPostalCode field in all records of the Orders entity
Orders.updateAll({ postalCode: postalCode })
</code></pre>
<p><strong>SQL Result:</strong></p>
<pre><code class="language-sql">-- Updates the ShipPostalCode field in all records of the Orders entity
UPDATE Orders o SET ShipPostalCode = ?
</code></pre>
<h2 id="update-one-field-of-entity-filtered">Update one field of entity filtered</h2>
<p><strong>Lambda:</strong></p>
<pre><code class="language-Typescript">// Updates the ShipName field of the Orders entity where OrderID matches the provided entity's ID
Orders.update({ name: entity.name }).filter(p =&gt; p.id === entity.id)
</code></pre>
<p><strong>SQL Result:</strong></p>
<pre><code class="language-sql">-- Updates the ShipName field of the Orders entity where OrderID matches the provided entity's ID
UPDATE Orders o SET ShipName = ? WHERE o.OrderID = ?
</code></pre>
<h2 id="update-one-field-of-entity-filtered-and-related-entity">Update one field of entity filtered and related entity</h2>
<p><strong>Lambda:</strong></p>
<pre><code class="language-Typescript">// Updates the ShipName field of the Orders entity and updates related details
Orders.update({ name: entity.name }).include(p =&gt; p.details(p =&gt; p)).filter(p =&gt; p.id === entity.id)
</code></pre>
<p><strong>SQL Result:</strong></p>
<pre><code class="language-sql">-- Updates the ShipName field of the Orders entity where OrderID matches the provided entity's ID
UPDATE Orders o SET ShipName = ? 
WHERE o.OrderID = ? 

-- Updates UnitPrice, Quantity, and Discount fields in the Order Details table where OrderID and ProductID 
-- match the provided parameters
UPDATE `Order Details` o1 SET UnitPrice = o1.UnitPrice,Quantity = o1.Quantity,Discount = o1.Discount 
WHERE (o1.OrderID = ? AND o1.ProductID = ?)
</code></pre>
<h2 id="update-one-field-of-entity-filtered-and-fields-of-related-entity">Update one field of entity filtered and fields of related entity</h2>
<p><strong>Lambda:</strong></p>
<pre><code class="language-Typescript">// Updates the ShipName field of the Orders entity and updates related details' UnitPrice and ProductID
Orders.update({ name: entity.name })
      .include(p =&gt; p.details(p =&gt; ({ unitPrice: p.unitPrice, productId: p.productId })))
            .filter(p =&gt; p.id === entity.id)
</code></pre>
<p><strong>SQL Result:</strong></p>
<pre><code class="language-sql">-- Updates the ShipName field of the Orders entity where OrderID matches the provided entity's ID
UPDATE Orders o SET ShipName = ?
WHERE o.OrderID = ?

-- Updates UnitPrice and ProductID fields in the Order Details table where OrderID and ProductID 
-- match the provided parameters
UPDATE `Order Details` o1 SET UnitPrice = o1.UnitPrice,ProductID = o1.ProductID 
WHERE (o1.OrderID = ? AND o1.ProductID = ?)
</code></pre>
<h2 id="update-entity-and-multiples-related-entities">Update entity and multiples related entities</h2>
<p><strong>Lambda:</strong></p>
<pre><code class="language-Typescript">// Updates all fields of the Customers entity and includes related orders and details
Customers.update().include(p =&gt; p.orders.include(p =&gt; p.details))
</code></pre>
<p><strong>SQL Result:</strong></p>
<pre><code class="language-sql">-- Updates all fields of the Customers entity where CustomerID matches the provided parameter
UPDATE Customers c SET CustomerID = ?,CompanyName = ?,ContactName = ?,ContactTitle = ?,Address = ?,City = ?,Region = ?,PostalCode = ?,Country = ? 
WHERE c.CustomerID = ? 

-- Updates all fields of the Orders entity where CustomerID matches the provided parameter
UPDATE Orders o SET CustomerID = ?,EmployeeID = ?,OrderDate = ?,RequiredDate = ?,ShippedDate = ?,ShipVia = ?,Freight = ?,ShipName = ?,ShipAddress = ?,ShipCity = ?,ShipRegion = ?,ShipPostalCode = ?,ShipCountry = ? 
WHERE o.OrderID = ? 

-- Updates all fields of the Order Details table where OrderID and ProductID match the provided parameters
UPDATE `Order Details` o1 SET OrderID = ?,ProductID = ?,UnitPrice = ?,Quantity = ?,Discount = ? 
WHERE (o1.OrderID = ? AND o1.ProductID = ?)
</code></pre>
<h2 id="code-example">Code example</h2>
<pre><code class="language-Typescript">import { orm } from '../../lib'
import { Customers } from '../northwind/model/__model'
(async () =&gt; {  
    try {       
        await orm.init('./config/northwind.yaml')
        // entity customer with orders and order details
        const customer = {
            id: 'ALFKI',
            name: 'Alfreds Futterkiste',
            contact: 'Maria Anders',
            phone: 'Sales Representative',
            address: 'Obere Str. 57',
            city: 'Berlin',
            region: null,
            postalCode: '12209',
            country: 'Germany',
            orders: [
                {
                    id: 1,
                    customerId: 'ALFKI',
                    employeeId: 6,
                    orderDate: '1997-08-24T22:00:00.000Z',
                    requiredDate: '1997-09-21T22:00:00.000Z',
                    shippedDate: '1997-09-01T22:00:00.000Z',
                    shipViaId: 1,
                    freight: '29.4600',
                    name: 'Alfreds Futterkiste',
                    address: 'Obere Str. 57',
                    city: 'Berlin',
                    region: null,
                    postalCode: '12209',
                    country: 'Germany',
                    details: [
                        {
                            orderId: 1,
                            productId: 28,
                            unitPrice: '45.6000',
                            quantity: '15.0000',
                            discount: '0.0000'
                        },
                        {
                            orderId: 1,
                            productId: 39,
                            unitPrice: '18.0000',
                            quantity: '21.0000',
                            discount: '0.0000'
                        },
                        {
                            orderId: 1,
                            productId: 46,
                            unitPrice: '12.0000',
                            quantity: '2.0000',
                            discount: '0.0000'
                        }
                    ]
                },
                {
                    id: 2,
                    customerId: 'ALFKI',
                    employeeId: 4,
                    orderDate: '1997-10-02T22:00:00.000Z',
                    requiredDate: '1997-10-30T23:00:00.000Z',
                    shippedDate: '1997-10-12T22:00:00.000Z',
                    shipViaId: 2,
                    freight: '61.0200',
                    name: 'Alfred-s Futterkiste',
                    address: 'Obere Str. 57',
                    city: 'Berlin',
                    region: null,
                    postalCode: '12209',
                    country: 'Germany',
                    details: [
                        {
                            orderId: 2,
                            productId: 63,
                            unitPrice: '43.9000',
                            quantity: '20.0000',
                            discount: '0.0000'
                        }
                    ]
                }
            ]
        }
        // Defining a query to update Customers and include related orders and details
        const query = () =&gt; Customers.update().include(p =&gt; p.orders.include(p =&gt; p.details))
        // Executing the query using the ORM with the specified customer parameter
        const result = await orm.execute(query, customer)
        console.log(JSON.stringify(result, null, 2))        
    } catch (error:any) {
        console.error(error.stack)
    } finally {
        // Ending the ORM connection
        await orm.end()
    }
})()
</code></pre>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
